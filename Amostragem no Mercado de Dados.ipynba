{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "7c86dadf",
   "metadata": {},
   "source": [
    "## **Descrição do Problema, Dados e Variáveis**  \n",
    "\n",
    "## **Problema**  \n",
    "O **State of Data Brazil 2023** mapeia o **mercado de trabalho na área de dados no Brasil**, identificando **tendências, desafios e oportunidades** para profissionais como **cientistas de dados, engenheiros de dados e analistas de dados**. Para garantir que os insights obtidos sejam representativos, é essencial aplicar técnicas adequadas de **amostragem de dados**. A escolha do método de amostragem influencia diretamente a **precisão das análises, a generalização dos resultados e a minimização de vieses**.  \n",
    "\n",
    "---\n",
    "\n",
    "### **Variáveis Relevantes**  \n",
    "##### **Informações Pessoais**  \n",
    "- **Identificador único (`P0`)** → *Qualitativa nominal* (identificação única, sem ordem)  \n",
    "- **Idade (`P1_a`)** → *Quantitativa discreta* (valores inteiros, como 25, 30, 40 anos)  \n",
    "- **Faixa etária (`P1_a_1`)** → *Qualitativa ordinal* (possui ordem: jovem, adulto, idoso, etc.)  \n",
    "- **Gênero (`P1_b`)** → *Qualitativa nominal* (categorias sem ordem)  \n",
    "- **Cor/Raça/Etnia (`P1_c`)** → *Qualitativa nominal* (categorias sem hierarquia)  \n",
    "- **Indica se é PCD (`P1_d`)** → *Qualitativa nominal* (sim/não, sem hierarquia)  \n",
    "\n",
    "##### **Impacto na Experiência Profissional**  \n",
    "- **Experiência profissional foi afetada? (`P1_e`)** → *Qualitativa nominal* (sim/não)  \n",
    "- **Motivos do impacto:**  \n",
    "  - **Raça/Etnia (`P1_e_2`)** → *Qualitativa nominal*  \n",
    "  - **Gênero (`P1_e_3`)** → *Qualitativa nominal*  \n",
    "  - **PCD (`P1_e_4`)** → *Qualitativa nominal*  \n",
    "\n",
    "##### **Aspectos Profissionais Prejudicados**  \n",
    "- **Quantidade de vagas recebidas (`P1_f_1`)** → *Quantitativa discreta* (número de vagas)  \n",
    "- **Nível das vagas x experiência (`P1_f_2`)** → *Qualitativa ordinal* (pode ser categorizado como adequado, abaixo do esperado, acima do esperado)  \n",
    "- **Sucesso em processos seletivos (`P1_f_3`)** → *Quantitativa discreta* (quantidade de aprovações)  \n",
    "- **Oportunidades de crescimento (`P1_f_4`)** → *Qualitativa ordinal* (poucas, médias, muitas oportunidades)  \n",
    "- **Rapidez na progressão de carreira (`P1_f_5`)** → *Qualitativa ordinal* (lenta, média, rápida)  \n",
    "- **Pressão e stress no trabalho (`P1_f_6`)** → *Qualitativa ordinal* (baixo, médio, alto)  \n",
    "- **Consideração dada às ideias (`P1_f_7`)** → *Qualitativa ordinal* (nunca, raramente, às vezes, frequentemente)  \n",
    "- **Relação com colegas no trabalho (`P1_f_8`)** → *Qualitativa ordinal* (ruim, neutra, boa, excelente)  \n",
    "- **Participação em eventos sociais no trabalho (`P1_f_9`)** → *Qualitativa nominal* (sim/não)  \n",
    "\n",
    "##### **Localização**  \n",
    "- **Reside no Brasil? (`P1_g`)** → *Qualitativa nominal* (sim/não)  \n",
    "- **Estado de residência (`P1_i`)** → *Qualitativa nominal* (categorias: SP, RJ, MG, etc.)  \n",
    "\n",
    "##### **Atividades Profissionais Específicas**  \n",
    "- **Criação/manutenção de infraestrutura (`P8_d_11`)** → *Qualitativa nominal* (sim/não)  \n",
    "- **Uso de LLMs para solucionar problemas de negócio (`P8_d_12`)** → *Qualitativa nominal* (sim/não)  \n",
    "\n",
    "\n",
    "## **Conclusão**  \n",
    "A definição de uma estratégia de amostragem adequada é crucial para garantir que as conclusões da pesquisa sejam **representativas e confiáveis**. A comparação entre **métodos de amostragem probabilística e não probabilística** permite avaliar qual abordagem reduz melhor os **erros relativos e distorções na análise**. Dessa forma, a pesquisa **State of Data Brazil 2023** pode fornecer um retrato fiel do mercado de trabalho na área de dados no Brasil.\n",
    "\n",
    "\n",
    "---"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "id": "b0c94f7d",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "\n",
    "def get_file_path():\n",
    "    import os\n",
    "    # Load the data\n",
    "    if os.path.exists('/kaggle'):\n",
    "        file_path = '/kaggle/input/state-of-data-brazil-2023/State_of_data_BR_2023_Kaggle - df_survey_2023.csv'\n",
    "    else:\n",
    "        default_directory = '/home/nerton/TRABALHO/Projects/kaggle'\n",
    "        os.chdir(default_directory)\n",
    "        file_path = './input/state-of-data-brazil-2023⁄State_of_data_BR_2023_Kaggle.csv'\n",
    "    return file_path\n",
    "\n",
    "# Carregando o DataFrame\n",
    "file_path = get_file_path()\n",
    "df = pd.read_csv(file_path)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "13387714",
   "metadata": {},
   "source": [
    "## Determinação do Tamanho da Amostra\n",
    "\n",
    "Para determinar o tamanho da amostra necessária para representar meu conjunto de dados, segui os seguintes passos:\n",
    "\n",
    "1. **Identifiquei os parâmetros necessários**:\n",
    "   - **Nível de confiança**: Foi escolhido um nível de confiança de 95%, o que corresponde a um valor crítico \\( Z = 1,96 \\).\n",
    "   - **Margem de erro**: Defini uma margem de erro plausível de 5% (\\( e = 0,05 \\)).\n",
    "   - **Proporção esperada**: Usei o valor padrão de 50% (\\( p = 0,5 \\)), já que não havia informações adicionais sobre a proporção da característica de interesse.\n",
    "   - **Tamanho da população (\\( N \\))**: Obtive o número total de registros no meu conjunto de dados utilizando `len(df)`.\n",
    "\n",
    "2. **Implementei o cálculo da Fórmula de Cochran para populações finita em Python**:\n",
    "   - Escrevi uma função para realizar o cálculo automaticamente, garantindo precisão e reprodutibilidade.\n",
    "\n",
    "3. **Resultado**:\n",
    "   - O tamanho da amostra foi calculado e armazenado na variável `sample_size`, representando o número de registros necessários para realizar uma análise estatística confiável.\n",
    "\n",
    "Esse processo me permitiu determinar o tamanho ideal da amostra, considerando o nível de confiança, a margem de erro e o tamanho da população."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "id": "eb182fde",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Tamanho da amostra necessário: 359\n"
     ]
    }
   ],
   "source": [
    "import math\n",
    "import scipy.stats as st\n",
    "\n",
    "def calculate_sample_size(population_size, confidence_level=0.95, margin_of_error=0.05, proportion=0.5):\n",
    "    if population_size <= 0:\n",
    "        raise ValueError(\"O tamanho da população deve ser maior que zero.\")\n",
    "    \n",
    "    # Obtém o valor crítico Z com base no nível de confiança\n",
    "    Z = st.norm.ppf(1 - (1 - confidence_level) / 2)\n",
    "    \n",
    "    # Calcula o tamanho da amostra para população infinita (Cochran)\n",
    "    n0 = (Z**2 * proportion * (1 - proportion)) / margin_of_error**2\n",
    "    \n",
    "    # Ajusta para população finita\n",
    "    n = n0 / (1 + ((n0 - 1) / population_size))\n",
    "\n",
    "    return math.ceil(n)  # Arredondar para cima\n",
    "\n",
    "# Calcula o tamanho da amostra\n",
    "population_size = len(df)  \n",
    "sample_size = calculate_sample_size(population_size, confidence_level=0.95, margin_of_error=0.05)\n",
    "print(f\"Tamanho da amostra necessário: {sample_size}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8dc3d7ec",
   "metadata": {},
   "source": [
    "## Construção de uma Amostra Aleatória Simples\n",
    "\n",
    "Para construir uma **amostra aleatória simples** do meu conjunto de dados, segui os seguintes passos:\n",
    "\n",
    "1. **Determinei o tamanho da amostra (\\( n \\))**:\n",
    "   - Utilizei o valor previamente calculado e armazenado na variável `sample_size`, que representa o número de registros necessários para a análise.\n",
    "\n",
    "2. **Realizei a amostragem aleatória**:\n",
    "   - Usei o método `sample` do Pandas para selecionar \\( n \\) registros de forma aleatória e sem reposição (\\( replace=False \\)).\n",
    "   - Para garantir a reprodutibilidade, defini uma semente aleatória com o parâmetro `random_state`.\n",
    "\n",
    "3. **Resultado**:\n",
    "   - A amostra aleatória simples foi gerada e armazenada na variável `sampleData`.\n",
    "   - Exibi os primeiros registros da amostra utilizando o método `head()`.\n",
    "\n",
    "Esse processo me permitiu criar uma amostra representativa do conjunto de dados, garantindo que cada registro tivesse a mesma probabilidade de ser selecionado."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "id": "bc9e5107",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>('P0', 'id')</th>\n",
       "      <th>('P1_a ', 'Idade')</th>\n",
       "      <th>('P1_a_1 ', 'Faixa idade')</th>\n",
       "      <th>('P1_b ', 'Genero')</th>\n",
       "      <th>('P1_c ', 'Cor/raca/etnia')</th>\n",
       "      <th>('P1_d ', 'PCD')</th>\n",
       "      <th>('P1_e ', 'experiencia_profissional_prejudicada')</th>\n",
       "      <th>('P1_e_1 ', 'Não acredito que minha experiência profissional seja afetada')</th>\n",
       "      <th>('P1_e_2 ', 'Experiencia prejudicada devido a minha Cor Raça Etnia')</th>\n",
       "      <th>('P1_e_3 ', 'Experiencia prejudicada devido a minha identidade de gênero')</th>\n",
       "      <th>...</th>\n",
       "      <th>('P8_d_3 ', 'Entrando em contato com os times de negócio para definição do problema, identificar a solução e apresentação de resultados.')</th>\n",
       "      <th>('P8_d_4 ', 'Desenvolvendo modelos de Machine Learning com o objetivo de colocar em produção em sistemas (produtos de dados).')</th>\n",
       "      <th>('P8_d_5 ', 'Colocando modelos em produção, criando os pipelines de dados, APIs de consumo e monitoramento.')</th>\n",
       "      <th>('P8_d_6 ', 'Cuidando da manutenção de modelos de Machine Learning já em produção, atuando no monitoramento, ajustes e refatoração quando necessário.')</th>\n",
       "      <th>('P8_d_7 ', 'Realizando construções de dashboards em ferramentas de BI como PowerBI, Tableau, Looker, Qlik, etc.')</th>\n",
       "      <th>('P8_d_8 ', 'Utilizando ferramentas avançadas de estatística como SAS, SPSS, Stata etc, para realizar análises.')</th>\n",
       "      <th>('P8_d_9 ', 'Criando e dando manutenção em ETLs, DAGs e automações de pipelines de dados.')</th>\n",
       "      <th>('P8_d_10 ', 'Criando e gerenciando soluções de Feature Store e cultura de MLOps.')</th>\n",
       "      <th>('P8_d_11 ', 'Criando e mantendo a infra que meus modelos e soluções rodam (clusters, servidores, API, containers, etc.)')</th>\n",
       "      <th>('P8_d_12 ', 'Treinando e aplicando LLM's para solucionar problemas de negócio.')</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4719</th>\n",
       "      <td>w62ll27e7dha788ou4lwuhssw62ll27m</td>\n",
       "      <td>31</td>\n",
       "      <td>30-34</td>\n",
       "      <td>Masculino</td>\n",
       "      <td>Preta</td>\n",
       "      <td>Não</td>\n",
       "      <td>Não acredito que minha experiência profissiona...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3062</th>\n",
       "      <td>l38o1wtr32guyd1zr92ul38o1ccavr9s</td>\n",
       "      <td>28</td>\n",
       "      <td>25-29</td>\n",
       "      <td>Masculino</td>\n",
       "      <td>Branca</td>\n",
       "      <td>Não</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4406</th>\n",
       "      <td>u4ppc535wdrcqlu4ppcvqz0oqlphawgp</td>\n",
       "      <td>35</td>\n",
       "      <td>35-39</td>\n",
       "      <td>Masculino</td>\n",
       "      <td>Parda</td>\n",
       "      <td>Não</td>\n",
       "      <td>Sim, acredito que a minha a experiência profis...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1454</th>\n",
       "      <td>a5lwr1ml9pvhldjpo1a5lwr1uppgf3gt</td>\n",
       "      <td>25</td>\n",
       "      <td>25-29</td>\n",
       "      <td>Masculino</td>\n",
       "      <td>Branca</td>\n",
       "      <td>Não</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1800</th>\n",
       "      <td>cbab9x12anb01spzftdcbab9lvc1wz2q</td>\n",
       "      <td>49</td>\n",
       "      <td>45-49</td>\n",
       "      <td>Masculino</td>\n",
       "      <td>Branca</td>\n",
       "      <td>Não</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 399 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                          ('P0', 'id')  ('P1_a ', 'Idade')  \\\n",
       "4719  w62ll27e7dha788ou4lwuhssw62ll27m                  31   \n",
       "3062  l38o1wtr32guyd1zr92ul38o1ccavr9s                  28   \n",
       "4406  u4ppc535wdrcqlu4ppcvqz0oqlphawgp                  35   \n",
       "1454  a5lwr1ml9pvhldjpo1a5lwr1uppgf3gt                  25   \n",
       "1800  cbab9x12anb01spzftdcbab9lvc1wz2q                  49   \n",
       "\n",
       "     ('P1_a_1 ', 'Faixa idade') ('P1_b ', 'Genero')  \\\n",
       "4719                      30-34           Masculino   \n",
       "3062                      25-29           Masculino   \n",
       "4406                      35-39           Masculino   \n",
       "1454                      25-29           Masculino   \n",
       "1800                      45-49           Masculino   \n",
       "\n",
       "     ('P1_c ', 'Cor/raca/etnia') ('P1_d ', 'PCD')  \\\n",
       "4719                       Preta              Não   \n",
       "3062                      Branca              Não   \n",
       "4406                       Parda              Não   \n",
       "1454                      Branca              Não   \n",
       "1800                      Branca              Não   \n",
       "\n",
       "      ('P1_e ', 'experiencia_profissional_prejudicada')  \\\n",
       "4719  Não acredito que minha experiência profissiona...   \n",
       "3062                                                NaN   \n",
       "4406  Sim, acredito que a minha a experiência profis...   \n",
       "1454                                                NaN   \n",
       "1800                                                NaN   \n",
       "\n",
       "      ('P1_e_1 ', 'Não acredito que minha experiência profissional seja afetada')  \\\n",
       "4719                                                1.0                             \n",
       "3062                                                NaN                             \n",
       "4406                                                0.0                             \n",
       "1454                                                NaN                             \n",
       "1800                                                NaN                             \n",
       "\n",
       "      ('P1_e_2 ', 'Experiencia prejudicada devido a minha Cor Raça Etnia')  \\\n",
       "4719                                                0.0                      \n",
       "3062                                                NaN                      \n",
       "4406                                                1.0                      \n",
       "1454                                                NaN                      \n",
       "1800                                                NaN                      \n",
       "\n",
       "      ('P1_e_3 ', 'Experiencia prejudicada devido a minha identidade de gênero')  \\\n",
       "4719                                                0.0                            \n",
       "3062                                                NaN                            \n",
       "4406                                                0.0                            \n",
       "1454                                                NaN                            \n",
       "1800                                                NaN                            \n",
       "\n",
       "      ...  \\\n",
       "4719  ...   \n",
       "3062  ...   \n",
       "4406  ...   \n",
       "1454  ...   \n",
       "1800  ...   \n",
       "\n",
       "      ('P8_d_3 ', 'Entrando em contato com os times de negócio para definição do problema, identificar a solução e apresentação de resultados.')  \\\n",
       "4719                                                NaN                                                                                            \n",
       "3062                                                NaN                                                                                            \n",
       "4406                                                NaN                                                                                            \n",
       "1454                                                0.0                                                                                            \n",
       "1800                                                NaN                                                                                            \n",
       "\n",
       "     ('P8_d_4 ', 'Desenvolvendo modelos de Machine Learning com o objetivo de colocar em produção em sistemas (produtos de dados).')  \\\n",
       "4719                                                NaN                                                                                \n",
       "3062                                                NaN                                                                                \n",
       "4406                                                NaN                                                                                \n",
       "1454                                                1.0                                                                                \n",
       "1800                                                NaN                                                                                \n",
       "\n",
       "      ('P8_d_5 ', 'Colocando modelos em produção, criando os pipelines de dados, APIs de consumo e monitoramento.')  \\\n",
       "4719                                                NaN                                                               \n",
       "3062                                                NaN                                                               \n",
       "4406                                                NaN                                                               \n",
       "1454                                                0.0                                                               \n",
       "1800                                                NaN                                                               \n",
       "\n",
       "      ('P8_d_6 ', 'Cuidando da manutenção de modelos de Machine Learning já em produção, atuando no monitoramento, ajustes e refatoração quando necessário.')  \\\n",
       "4719                                                NaN                                                                                                         \n",
       "3062                                                NaN                                                                                                         \n",
       "4406                                                NaN                                                                                                         \n",
       "1454                                                0.0                                                                                                         \n",
       "1800                                                NaN                                                                                                         \n",
       "\n",
       "      ('P8_d_7 ', 'Realizando construções de dashboards em ferramentas de BI como PowerBI, Tableau, Looker, Qlik, etc.')  \\\n",
       "4719                                                NaN                                                                    \n",
       "3062                                                NaN                                                                    \n",
       "4406                                                NaN                                                                    \n",
       "1454                                                0.0                                                                    \n",
       "1800                                                NaN                                                                    \n",
       "\n",
       "      ('P8_d_8 ', 'Utilizando ferramentas avançadas de estatística como SAS, SPSS, Stata etc, para realizar análises.')  \\\n",
       "4719                                                NaN                                                                   \n",
       "3062                                                NaN                                                                   \n",
       "4406                                                NaN                                                                   \n",
       "1454                                                0.0                                                                   \n",
       "1800                                                NaN                                                                   \n",
       "\n",
       "      ('P8_d_9 ', 'Criando e dando manutenção em ETLs, DAGs e automações de pipelines de dados.')  \\\n",
       "4719                                                NaN                                             \n",
       "3062                                                NaN                                             \n",
       "4406                                                NaN                                             \n",
       "1454                                                0.0                                             \n",
       "1800                                                NaN                                             \n",
       "\n",
       "      ('P8_d_10 ', 'Criando e gerenciando soluções de Feature Store e cultura de MLOps.')  \\\n",
       "4719                                                NaN                                     \n",
       "3062                                                NaN                                     \n",
       "4406                                                NaN                                     \n",
       "1454                                                0.0                                     \n",
       "1800                                                NaN                                     \n",
       "\n",
       "      ('P8_d_11 ', 'Criando e mantendo a infra que meus modelos e soluções rodam (clusters, servidores, API, containers, etc.)')  \\\n",
       "4719                                                NaN                                                                            \n",
       "3062                                                NaN                                                                            \n",
       "4406                                                NaN                                                                            \n",
       "1454                                                0.0                                                                            \n",
       "1800                                                NaN                                                                            \n",
       "\n",
       "      ('P8_d_12 ', 'Treinando e aplicando LLM's para solucionar problemas de negócio.')  \n",
       "4719                                                NaN                                  \n",
       "3062                                                NaN                                  \n",
       "4406                                                NaN                                  \n",
       "1454                                                0.0                                  \n",
       "1800                                                NaN                                  \n",
       "\n",
       "[5 rows x 399 columns]"
      ]
     },
     "execution_count": 154,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# amostragem aleatoria simples - AASimples\n",
    "def getSimpleRandomSample(dataFrame, sampleSize):\n",
    "    # N = len(dataFrame) #tamanho da população\n",
    "    # n = sampleSize # tamanho da amostra\n",
    "    # amostra aleatória de índices\n",
    "    # sampleIndexes = sample(x = 1:N, size = n, replace = FALSE)\n",
    "    # separando a amostra aleatória correspondente aos índices sorteados\n",
    "    #sampleData = dataFrame[sampleIndexes, ]\n",
    "    sampleData = df.sample(n=sampleSize, replace=False)\n",
    "    return (sampleData)\n",
    "\n",
    "sampleData = getSimpleRandomSample(df, sample_size)\n",
    "sampleData.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a77137bf",
   "metadata": {},
   "source": [
    "## Construção de uma Amostra Aleatória Sistemática\n",
    "\n",
    "Para construir uma **amostra aleatória sistemática** do meu conjunto de dados, segui os seguintes passos:\n",
    "\n",
    "1. **Determinei o intervalo de seleção (\\( k \\))**:\n",
    "   - Dividi o tamanho total da população (\\( N \\)) pelo tamanho da amostra desejada (\\( n \\)).\n",
    "   - O intervalo \\( k \\) foi calculado como \\( k = N // n \\).\n",
    "\n",
    "2. **Escolhi um índice inicial aleatório**:\n",
    "   - Utilizei a função `np.random.randint` para selecionar um índice inicial entre 0 e \\( k-1 \\), garantindo a aleatoriedade no início do processo.\n",
    "\n",
    "3. **Selecionei os registros sistematicamente**:\n",
    "   - A partir do índice inicial, selecionei os registros do conjunto de dados com um intervalo fixo (\\( k \\)) até atingir o tamanho da amostra desejada.\n",
    "\n",
    "4. **Resultado**:\n",
    "   - A amostra sistemática foi gerada e exibida, representando de forma eficiente a população do conjunto de dados.\n",
    "\n",
    "Esse processo me permitiu criar uma amostra representativa, combinando aleatoriedade inicial e seleção sistemática."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 155,
   "id": "48ccd940",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                          ('P0', 'id')  ('P1_a ', 'Idade')  \\\n",
      "3     00urm3jf2cek12w6ygue00urm3jzd17j                  22   \n",
      "17    04ellbzcl7lj3va9n1yx04eleu3mlvml                  29   \n",
      "31    07podb88144utvmy9lk0x07podb8k8nl                  38   \n",
      "45    0baz3khrxi0sei0bazgztvrrugudi1wd                  50   \n",
      "59    0e6w1fl8ezu3h7bnef0e6w1fl8ekby7x                  32   \n",
      "...                                ...                 ...   \n",
      "5225  zjd99eif0xyfitla1fzjd994tuprnpdi                  43   \n",
      "5239  zmg2n1x3lt3srizmg2qx8gyj03irqrqm                  26   \n",
      "5253  zoz1ywsdz67h9mxzoz1ywpsakknb543o                  30   \n",
      "5267  zt22hikxu88pudmz6nie2jtvortyzt22                  35   \n",
      "5281  zws1zie6ro3he9ln337yufzws1zyj7nw                  23   \n",
      "\n",
      "     ('P1_a_1 ', 'Faixa idade') ('P1_b ', 'Genero')  \\\n",
      "3                         22-24           Masculino   \n",
      "17                        25-29            Feminino   \n",
      "31                        35-39           Masculino   \n",
      "45                        50-54            Feminino   \n",
      "59                        30-34           Masculino   \n",
      "...                         ...                 ...   \n",
      "5225                      40-44           Masculino   \n",
      "5239                      25-29           Masculino   \n",
      "5253                      30-34           Masculino   \n",
      "5267                      35-39           Masculino   \n",
      "5281                      22-24           Masculino   \n",
      "\n",
      "     ('P1_c ', 'Cor/raca/etnia') ('P1_d ', 'PCD')  \\\n",
      "3                          Preta              Não   \n",
      "17          Prefiro não informar              Não   \n",
      "31                         Preta              Não   \n",
      "45                         Parda              Não   \n",
      "59                        Branca              Não   \n",
      "...                          ...              ...   \n",
      "5225                       Parda              Não   \n",
      "5239                       Parda              Não   \n",
      "5253                      Branca              Não   \n",
      "5267                      Branca              Não   \n",
      "5281                       Parda              Não   \n",
      "\n",
      "      ('P1_e ', 'experiencia_profissional_prejudicada')  \\\n",
      "3     Não acredito que minha experiência profissiona...   \n",
      "17    Sim, acredito que a minha a experiência profis...   \n",
      "31    Não acredito que minha experiência profissiona...   \n",
      "45    Sim, acredito que a minha a experiência profis...   \n",
      "59                                                  NaN   \n",
      "...                                                 ...   \n",
      "5225  Sim, acredito que a minha a experiência profis...   \n",
      "5239  Não acredito que minha experiência profissiona...   \n",
      "5253                                                NaN   \n",
      "5267                                                NaN   \n",
      "5281  Não acredito que minha experiência profissiona...   \n",
      "\n",
      "      ('P1_e_1 ', 'Não acredito que minha experiência profissional seja afetada')  \\\n",
      "3                                                   1.0                             \n",
      "17                                                  0.0                             \n",
      "31                                                  1.0                             \n",
      "45                                                  0.0                             \n",
      "59                                                  NaN                             \n",
      "...                                                 ...                             \n",
      "5225                                                0.0                             \n",
      "5239                                                1.0                             \n",
      "5253                                                NaN                             \n",
      "5267                                                NaN                             \n",
      "5281                                                1.0                             \n",
      "\n",
      "      ('P1_e_2 ', 'Experiencia prejudicada devido a minha Cor Raça Etnia')  \\\n",
      "3                                                   0.0                      \n",
      "17                                                  0.0                      \n",
      "31                                                  0.0                      \n",
      "45                                                  0.0                      \n",
      "59                                                  NaN                      \n",
      "...                                                 ...                      \n",
      "5225                                                1.0                      \n",
      "5239                                                0.0                      \n",
      "5253                                                NaN                      \n",
      "5267                                                NaN                      \n",
      "5281                                                0.0                      \n",
      "\n",
      "      ('P1_e_3 ', 'Experiencia prejudicada devido a minha identidade de gênero')  \\\n",
      "3                                                   0.0                            \n",
      "17                                                  1.0                            \n",
      "31                                                  0.0                            \n",
      "45                                                  1.0                            \n",
      "59                                                  NaN                            \n",
      "...                                                 ...                            \n",
      "5225                                                0.0                            \n",
      "5239                                                0.0                            \n",
      "5253                                                NaN                            \n",
      "5267                                                NaN                            \n",
      "5281                                                0.0                            \n",
      "\n",
      "      ...  \\\n",
      "3     ...   \n",
      "17    ...   \n",
      "31    ...   \n",
      "45    ...   \n",
      "59    ...   \n",
      "...   ...   \n",
      "5225  ...   \n",
      "5239  ...   \n",
      "5253  ...   \n",
      "5267  ...   \n",
      "5281  ...   \n",
      "\n",
      "      ('P8_d_3 ', 'Entrando em contato com os times de negócio para definição do problema, identificar a solução e apresentação de resultados.')  \\\n",
      "3                                                   NaN                                                                                            \n",
      "17                                                  NaN                                                                                            \n",
      "31                                                  1.0                                                                                            \n",
      "45                                                  NaN                                                                                            \n",
      "59                                                  NaN                                                                                            \n",
      "...                                                 ...                                                                                            \n",
      "5225                                                NaN                                                                                            \n",
      "5239                                                NaN                                                                                            \n",
      "5253                                                NaN                                                                                            \n",
      "5267                                                NaN                                                                                            \n",
      "5281                                                NaN                                                                                            \n",
      "\n",
      "     ('P8_d_4 ', 'Desenvolvendo modelos de Machine Learning com o objetivo de colocar em produção em sistemas (produtos de dados).')  \\\n",
      "3                                                   NaN                                                                                \n",
      "17                                                  NaN                                                                                \n",
      "31                                                  0.0                                                                                \n",
      "45                                                  NaN                                                                                \n",
      "59                                                  NaN                                                                                \n",
      "...                                                 ...                                                                                \n",
      "5225                                                NaN                                                                                \n",
      "5239                                                NaN                                                                                \n",
      "5253                                                NaN                                                                                \n",
      "5267                                                NaN                                                                                \n",
      "5281                                                NaN                                                                                \n",
      "\n",
      "      ('P8_d_5 ', 'Colocando modelos em produção, criando os pipelines de dados, APIs de consumo e monitoramento.')  \\\n",
      "3                                                   NaN                                                               \n",
      "17                                                  NaN                                                               \n",
      "31                                                  0.0                                                               \n",
      "45                                                  NaN                                                               \n",
      "59                                                  NaN                                                               \n",
      "...                                                 ...                                                               \n",
      "5225                                                NaN                                                               \n",
      "5239                                                NaN                                                               \n",
      "5253                                                NaN                                                               \n",
      "5267                                                NaN                                                               \n",
      "5281                                                NaN                                                               \n",
      "\n",
      "      ('P8_d_6 ', 'Cuidando da manutenção de modelos de Machine Learning já em produção, atuando no monitoramento, ajustes e refatoração quando necessário.')  \\\n",
      "3                                                   NaN                                                                                                         \n",
      "17                                                  NaN                                                                                                         \n",
      "31                                                  0.0                                                                                                         \n",
      "45                                                  NaN                                                                                                         \n",
      "59                                                  NaN                                                                                                         \n",
      "...                                                 ...                                                                                                         \n",
      "5225                                                NaN                                                                                                         \n",
      "5239                                                NaN                                                                                                         \n",
      "5253                                                NaN                                                                                                         \n",
      "5267                                                NaN                                                                                                         \n",
      "5281                                                NaN                                                                                                         \n",
      "\n",
      "      ('P8_d_7 ', 'Realizando construções de dashboards em ferramentas de BI como PowerBI, Tableau, Looker, Qlik, etc.')  \\\n",
      "3                                                   NaN                                                                    \n",
      "17                                                  NaN                                                                    \n",
      "31                                                  0.0                                                                    \n",
      "45                                                  NaN                                                                    \n",
      "59                                                  NaN                                                                    \n",
      "...                                                 ...                                                                    \n",
      "5225                                                NaN                                                                    \n",
      "5239                                                NaN                                                                    \n",
      "5253                                                NaN                                                                    \n",
      "5267                                                NaN                                                                    \n",
      "5281                                                NaN                                                                    \n",
      "\n",
      "      ('P8_d_8 ', 'Utilizando ferramentas avançadas de estatística como SAS, SPSS, Stata etc, para realizar análises.')  \\\n",
      "3                                                   NaN                                                                   \n",
      "17                                                  NaN                                                                   \n",
      "31                                                  0.0                                                                   \n",
      "45                                                  NaN                                                                   \n",
      "59                                                  NaN                                                                   \n",
      "...                                                 ...                                                                   \n",
      "5225                                                NaN                                                                   \n",
      "5239                                                NaN                                                                   \n",
      "5253                                                NaN                                                                   \n",
      "5267                                                NaN                                                                   \n",
      "5281                                                NaN                                                                   \n",
      "\n",
      "      ('P8_d_9 ', 'Criando e dando manutenção em ETLs, DAGs e automações de pipelines de dados.')  \\\n",
      "3                                                   NaN                                             \n",
      "17                                                  NaN                                             \n",
      "31                                                  1.0                                             \n",
      "45                                                  NaN                                             \n",
      "59                                                  NaN                                             \n",
      "...                                                 ...                                             \n",
      "5225                                                NaN                                             \n",
      "5239                                                NaN                                             \n",
      "5253                                                NaN                                             \n",
      "5267                                                NaN                                             \n",
      "5281                                                NaN                                             \n",
      "\n",
      "      ('P8_d_10 ', 'Criando e gerenciando soluções de Feature Store e cultura de MLOps.')  \\\n",
      "3                                                   NaN                                     \n",
      "17                                                  NaN                                     \n",
      "31                                                  0.0                                     \n",
      "45                                                  NaN                                     \n",
      "59                                                  NaN                                     \n",
      "...                                                 ...                                     \n",
      "5225                                                NaN                                     \n",
      "5239                                                NaN                                     \n",
      "5253                                                NaN                                     \n",
      "5267                                                NaN                                     \n",
      "5281                                                NaN                                     \n",
      "\n",
      "      ('P8_d_11 ', 'Criando e mantendo a infra que meus modelos e soluções rodam (clusters, servidores, API, containers, etc.)')  \\\n",
      "3                                                   NaN                                                                            \n",
      "17                                                  NaN                                                                            \n",
      "31                                                  0.0                                                                            \n",
      "45                                                  NaN                                                                            \n",
      "59                                                  NaN                                                                            \n",
      "...                                                 ...                                                                            \n",
      "5225                                                NaN                                                                            \n",
      "5239                                                NaN                                                                            \n",
      "5253                                                NaN                                                                            \n",
      "5267                                                NaN                                                                            \n",
      "5281                                                NaN                                                                            \n",
      "\n",
      "      ('P8_d_12 ', 'Treinando e aplicando LLM's para solucionar problemas de negócio.')  \n",
      "3                                                   NaN                                  \n",
      "17                                                  NaN                                  \n",
      "31                                                  0.0                                  \n",
      "45                                                  NaN                                  \n",
      "59                                                  NaN                                  \n",
      "...                                                 ...                                  \n",
      "5225                                                NaN                                  \n",
      "5239                                                NaN                                  \n",
      "5253                                                NaN                                  \n",
      "5267                                                NaN                                  \n",
      "5281                                                NaN                                  \n",
      "\n",
      "[378 rows x 399 columns]\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "\n",
    "def systematic_sampling(dataFrame, sample_size):\n",
    "    population_size = len(dataFrame)\n",
    "    k = population_size // sample_size  # Intervalo de seleção\n",
    "    random_start = np.random.randint(0, k)  # Índice inicial aleatório\n",
    "    # Seleciona os índices sistematicamente\n",
    "    systematic_indices = list(range(random_start, population_size, k))\n",
    "    # Retorna os registros correspondentes aos índices selecionados\n",
    "    return dataFrame.iloc[systematic_indices]\n",
    "\n",
    "# Construindo a amostra sistemática\n",
    "systematic_sample = systematic_sampling(df, sample_size)\n",
    "\n",
    "# Exibindo a amostra\n",
    "print(systematic_sample)\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5eec39df",
   "metadata": {},
   "source": [
    "## Construção de uma Amostra Aleatória Estratificada Proporcional\n",
    "\n",
    "Para construir uma **amostra aleatória estratificada proporcional** do meu conjunto de dados, segui os seguintes passos:\n",
    "\n",
    "1. **Escolhi a variável de estratificação**:\n",
    "   - Selecionei uma variável qualitativa do conjunto de dados que está associada à variável dependente, para garantir que os estratos reflitam características importantes da população.\n",
    "\n",
    "2. **Determinei o tamanho da amostra para cada estrato**:\n",
    "   - Calculei o tamanho proporcional de cada estrato com base na frequência relativa de cada categoria da variável de estratificação.\n",
    "   - Para cada estrato, o tamanho da amostra foi calculado como:\n",
    "     \\[\n",
    "     n_i = \\frac{N_i}{N} \\cdot n\n",
    "     \\]\n",
    "     Onde:\n",
    "     - \\( N_i \\): Tamanho do estrato \\( i \\).\n",
    "     - \\( N \\): Tamanho total da população.\n",
    "     - \\( n \\): Tamanho total da amostra.\n",
    "\n",
    "3. **Realizei a amostragem aleatória dentro de cada estrato**:\n",
    "   - Usei o método `sample` do Pandas para selecionar registros aleatórios dentro de cada estrato, respeitando o tamanho proporcional calculado.\n",
    "\n",
    "4. **Combinei as amostras dos estratos**:\n",
    "   - Após realizar a amostragem em cada estrato, combinei os registros selecionados para formar a amostra final.\n",
    "\n",
    "5. **Resultado**:\n",
    "   - A amostra estratificada proporcional foi gerada e armazenada na variável `stratified_sample`.\n",
    "   - Exibi os primeiros registros da amostra utilizando o método `head()`.\n",
    "\n",
    "Esse processo me permitiu criar uma amostra representativa do conjunto de dados, garantindo que cada estrato fosse proporcionalmente representado na amostra final."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 156,
   "id": "bf86afb8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "('P2_g ', 'Nivel')\n",
      "Sênior    0.367903\n",
      "Pleno     0.360902\n",
      "Júnior    0.271195\n",
      "Name: proportion, dtype: float64\n",
      "('P2_g ', 'Nivel')\n",
      "Sênior    0.367903\n",
      "Pleno     0.360902\n",
      "Júnior    0.271195\n",
      "Name: proportion, dtype: float64\n",
      "                          ('P0', 'id')  ('P1_a ', 'Idade')  \\\n",
      "5286  zy2x71m6qqffo5th4t8zy2x713efewf5                  37   \n",
      "4075  rx81h0f9bnz1zh0sarx81h93wo4ssj5y                  27   \n",
      "1914  d57t5v563ncavq5is9d57t5cmuxeawri                  47   \n",
      "1975  dl5zf6udidhzdl5kbbh4gsr2b67bzjuk                  36   \n",
      "912   69v3utvxeos32vc2fb1t69v3ura9z3rl                  38   \n",
      "...                                ...                 ...   \n",
      "1877  csk2t418optfvw3t7aplf2lcsk2t418q                  43   \n",
      "3202  m2pbsdc3uvagcotdblm2pbvwfudpx8by                  51   \n",
      "1079  7g7sm94xiknudo42dh7g7sovondl88vp                  39   \n",
      "3993  rdelmfu4u6o03opmsz8qhfmzrdelmfuh                  33   \n",
      "2914  k0f5a58ji94i1nk0f5ao13xkfy7x34h8                  31   \n",
      "\n",
      "     ('P1_a_1 ', 'Faixa idade') ('P1_b ', 'Genero')  \\\n",
      "5286                      35-39           Masculino   \n",
      "4075                      25-29           Masculino   \n",
      "1914                      45-49           Masculino   \n",
      "1975                      35-39            Feminino   \n",
      "912                       35-39            Feminino   \n",
      "...                         ...                 ...   \n",
      "1877                      40-44            Feminino   \n",
      "3202                      50-54           Masculino   \n",
      "1079                      35-39           Masculino   \n",
      "3993                      30-34           Masculino   \n",
      "2914                      30-34            Feminino   \n",
      "\n",
      "     ('P1_c ', 'Cor/raca/etnia') ('P1_d ', 'PCD')  \\\n",
      "5286                      Branca              Não   \n",
      "4075                      Branca              Não   \n",
      "1914                       Parda              Não   \n",
      "1975                       Parda              Não   \n",
      "912                       Branca              Não   \n",
      "...                          ...              ...   \n",
      "1877                      Branca              Não   \n",
      "3202                      Branca              Não   \n",
      "1079                       Parda              Não   \n",
      "3993                       Parda              Não   \n",
      "2914                      Branca              Não   \n",
      "\n",
      "      ('P1_e ', 'experiencia_profissional_prejudicada')  \\\n",
      "5286                                                NaN   \n",
      "4075                                                NaN   \n",
      "1914  Não acredito que minha experiência profissiona...   \n",
      "1975  Sim, acredito que a minha a experiência profis...   \n",
      "912   Não acredito que minha experiência profissiona...   \n",
      "...                                                 ...   \n",
      "1877  Sim, acredito que a minha a experiência profis...   \n",
      "3202                                                NaN   \n",
      "1079  Sim, acredito que a minha a experiência profis...   \n",
      "3993  Não acredito que minha experiência profissiona...   \n",
      "2914  Sim, acredito que a minha a experiência profis...   \n",
      "\n",
      "      ('P1_e_1 ', 'Não acredito que minha experiência profissional seja afetada')  \\\n",
      "5286                                                NaN                             \n",
      "4075                                                NaN                             \n",
      "1914                                                1.0                             \n",
      "1975                                                0.0                             \n",
      "912                                                 1.0                             \n",
      "...                                                 ...                             \n",
      "1877                                                0.0                             \n",
      "3202                                                NaN                             \n",
      "1079                                                0.0                             \n",
      "3993                                                1.0                             \n",
      "2914                                                0.0                             \n",
      "\n",
      "      ('P1_e_2 ', 'Experiencia prejudicada devido a minha Cor Raça Etnia')  \\\n",
      "5286                                                NaN                      \n",
      "4075                                                NaN                      \n",
      "1914                                                0.0                      \n",
      "1975                                                1.0                      \n",
      "912                                                 0.0                      \n",
      "...                                                 ...                      \n",
      "1877                                                1.0                      \n",
      "3202                                                NaN                      \n",
      "1079                                                1.0                      \n",
      "3993                                                0.0                      \n",
      "2914                                                0.0                      \n",
      "\n",
      "      ('P1_e_3 ', 'Experiencia prejudicada devido a minha identidade de gênero')  \\\n",
      "5286                                                NaN                            \n",
      "4075                                                NaN                            \n",
      "1914                                                0.0                            \n",
      "1975                                                0.0                            \n",
      "912                                                 0.0                            \n",
      "...                                                 ...                            \n",
      "1877                                                0.0                            \n",
      "3202                                                NaN                            \n",
      "1079                                                0.0                            \n",
      "3993                                                0.0                            \n",
      "2914                                                1.0                            \n",
      "\n",
      "      ...  \\\n",
      "5286  ...   \n",
      "4075  ...   \n",
      "1914  ...   \n",
      "1975  ...   \n",
      "912   ...   \n",
      "...   ...   \n",
      "1877  ...   \n",
      "3202  ...   \n",
      "1079  ...   \n",
      "3993  ...   \n",
      "2914  ...   \n",
      "\n",
      "      ('P8_d_3 ', 'Entrando em contato com os times de negócio para definição do problema, identificar a solução e apresentação de resultados.')  \\\n",
      "5286                                                NaN                                                                                            \n",
      "4075                                                NaN                                                                                            \n",
      "1914                                                NaN                                                                                            \n",
      "1975                                                NaN                                                                                            \n",
      "912                                                 NaN                                                                                            \n",
      "...                                                 ...                                                                                            \n",
      "1877                                                NaN                                                                                            \n",
      "3202                                                NaN                                                                                            \n",
      "1079                                                NaN                                                                                            \n",
      "3993                                                NaN                                                                                            \n",
      "2914                                                NaN                                                                                            \n",
      "\n",
      "     ('P8_d_4 ', 'Desenvolvendo modelos de Machine Learning com o objetivo de colocar em produção em sistemas (produtos de dados).')  \\\n",
      "5286                                                NaN                                                                                \n",
      "4075                                                NaN                                                                                \n",
      "1914                                                NaN                                                                                \n",
      "1975                                                NaN                                                                                \n",
      "912                                                 NaN                                                                                \n",
      "...                                                 ...                                                                                \n",
      "1877                                                NaN                                                                                \n",
      "3202                                                NaN                                                                                \n",
      "1079                                                NaN                                                                                \n",
      "3993                                                NaN                                                                                \n",
      "2914                                                NaN                                                                                \n",
      "\n",
      "      ('P8_d_5 ', 'Colocando modelos em produção, criando os pipelines de dados, APIs de consumo e monitoramento.')  \\\n",
      "5286                                                NaN                                                               \n",
      "4075                                                NaN                                                               \n",
      "1914                                                NaN                                                               \n",
      "1975                                                NaN                                                               \n",
      "912                                                 NaN                                                               \n",
      "...                                                 ...                                                               \n",
      "1877                                                NaN                                                               \n",
      "3202                                                NaN                                                               \n",
      "1079                                                NaN                                                               \n",
      "3993                                                NaN                                                               \n",
      "2914                                                NaN                                                               \n",
      "\n",
      "      ('P8_d_6 ', 'Cuidando da manutenção de modelos de Machine Learning já em produção, atuando no monitoramento, ajustes e refatoração quando necessário.')  \\\n",
      "5286                                                NaN                                                                                                         \n",
      "4075                                                NaN                                                                                                         \n",
      "1914                                                NaN                                                                                                         \n",
      "1975                                                NaN                                                                                                         \n",
      "912                                                 NaN                                                                                                         \n",
      "...                                                 ...                                                                                                         \n",
      "1877                                                NaN                                                                                                         \n",
      "3202                                                NaN                                                                                                         \n",
      "1079                                                NaN                                                                                                         \n",
      "3993                                                NaN                                                                                                         \n",
      "2914                                                NaN                                                                                                         \n",
      "\n",
      "      ('P8_d_7 ', 'Realizando construções de dashboards em ferramentas de BI como PowerBI, Tableau, Looker, Qlik, etc.')  \\\n",
      "5286                                                NaN                                                                    \n",
      "4075                                                NaN                                                                    \n",
      "1914                                                NaN                                                                    \n",
      "1975                                                NaN                                                                    \n",
      "912                                                 NaN                                                                    \n",
      "...                                                 ...                                                                    \n",
      "1877                                                NaN                                                                    \n",
      "3202                                                NaN                                                                    \n",
      "1079                                                NaN                                                                    \n",
      "3993                                                NaN                                                                    \n",
      "2914                                                NaN                                                                    \n",
      "\n",
      "      ('P8_d_8 ', 'Utilizando ferramentas avançadas de estatística como SAS, SPSS, Stata etc, para realizar análises.')  \\\n",
      "5286                                                NaN                                                                   \n",
      "4075                                                NaN                                                                   \n",
      "1914                                                NaN                                                                   \n",
      "1975                                                NaN                                                                   \n",
      "912                                                 NaN                                                                   \n",
      "...                                                 ...                                                                   \n",
      "1877                                                NaN                                                                   \n",
      "3202                                                NaN                                                                   \n",
      "1079                                                NaN                                                                   \n",
      "3993                                                NaN                                                                   \n",
      "2914                                                NaN                                                                   \n",
      "\n",
      "      ('P8_d_9 ', 'Criando e dando manutenção em ETLs, DAGs e automações de pipelines de dados.')  \\\n",
      "5286                                                NaN                                             \n",
      "4075                                                NaN                                             \n",
      "1914                                                NaN                                             \n",
      "1975                                                NaN                                             \n",
      "912                                                 NaN                                             \n",
      "...                                                 ...                                             \n",
      "1877                                                NaN                                             \n",
      "3202                                                NaN                                             \n",
      "1079                                                NaN                                             \n",
      "3993                                                NaN                                             \n",
      "2914                                                NaN                                             \n",
      "\n",
      "      ('P8_d_10 ', 'Criando e gerenciando soluções de Feature Store e cultura de MLOps.')  \\\n",
      "5286                                                NaN                                     \n",
      "4075                                                NaN                                     \n",
      "1914                                                NaN                                     \n",
      "1975                                                NaN                                     \n",
      "912                                                 NaN                                     \n",
      "...                                                 ...                                     \n",
      "1877                                                NaN                                     \n",
      "3202                                                NaN                                     \n",
      "1079                                                NaN                                     \n",
      "3993                                                NaN                                     \n",
      "2914                                                NaN                                     \n",
      "\n",
      "      ('P8_d_11 ', 'Criando e mantendo a infra que meus modelos e soluções rodam (clusters, servidores, API, containers, etc.)')  \\\n",
      "5286                                                NaN                                                                            \n",
      "4075                                                NaN                                                                            \n",
      "1914                                                NaN                                                                            \n",
      "1975                                                NaN                                                                            \n",
      "912                                                 NaN                                                                            \n",
      "...                                                 ...                                                                            \n",
      "1877                                                NaN                                                                            \n",
      "3202                                                NaN                                                                            \n",
      "1079                                                NaN                                                                            \n",
      "3993                                                NaN                                                                            \n",
      "2914                                                NaN                                                                            \n",
      "\n",
      "      ('P8_d_12 ', 'Treinando e aplicando LLM's para solucionar problemas de negócio.')  \n",
      "5286                                                NaN                                  \n",
      "4075                                                NaN                                  \n",
      "1914                                                NaN                                  \n",
      "1975                                                NaN                                  \n",
      "912                                                 NaN                                  \n",
      "...                                                 ...                                  \n",
      "1877                                                NaN                                  \n",
      "3202                                                NaN                                  \n",
      "1079                                                NaN                                  \n",
      "3993                                                NaN                                  \n",
      "2914                                                NaN                                  \n",
      "\n",
      "[359 rows x 399 columns]\n"
     ]
    }
   ],
   "source": [
    "# amostragem aleatoria estratificada proporcional - AAEstrProp\n",
    "def getProportionalStratifiedRandomSample(dataFrame, sampleSize, stratumVariable):\n",
    "  # distribuição da variável de estrato na população\n",
    "  n = sampleSize\n",
    "\n",
    "  probDist = dataFrame[stratumVariable].value_counts(normalize=True) # View(probDist)\n",
    "  print(probDist)\n",
    "\n",
    "  # Lista de estratos\n",
    "  stratums = probDist.index.to_list()\n",
    "  sampleData = pd.DataFrame()\n",
    "\n",
    "  # Gerar amostras para cada estrato\n",
    "  for stratum_i in stratums:\n",
    "      dataFrame_i = dataFrame[dataFrame[stratumVariable] == stratum_i]\n",
    "      n_i = round(n * probDist[stratum_i])  # Tamanho da amostra para o estrato\n",
    "      sampleData_i = getSimpleRandomSample(dataFrame=dataFrame_i, sampleSize=n_i)\n",
    "      sampleData = pd.concat([sampleData, sampleData_i], axis=0)\n",
    "  \n",
    "  return sampleData\n",
    "\n",
    "stratum_variable = \"('P2_g ', 'Nivel')\"\n",
    "sampleData = getProportionalStratifiedRandomSample(dataFrame=df, sampleSize=sample_size, stratumVariable=stratum_variable)\n",
    "# Gerar a amostra estratificada proporcional\n",
    "stratified_sample = getProportionalStratifiedRandomSample(\n",
    "    dataFrame=df,\n",
    "    sampleSize=sample_size,\n",
    "    stratumVariable=stratum_variable\n",
    ")\n",
    "# Visualizar a amostra gerada\n",
    "print(stratified_sample)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "806acb54",
   "metadata": {},
   "source": [
    "## Comparação do Desempenho das Amostras Geradas\n",
    "\n",
    "Para comparar o desempenho das amostras geradas, utilizei o **erro relativo** que cada uma comete ao inferir o valor médio da variável dependente no conjunto completo. Segui os seguintes passos:\n",
    "\n",
    "1. **Calculei o valor médio da variável dependente no conjunto completo**:\n",
    "   - Utilizei o método `mean()` do Pandas para calcular o valor médio da variável dependente no dataset original.\n",
    "\n",
    "2. **Calculei o valor médio da variável dependente em cada amostra**:\n",
    "   - Para cada amostra gerada (aleatória simples, sistemática e estratificada), calculei o valor médio da variável dependente.\n",
    "\n",
    "3. **Determinei o erro relativo para cada amostra**:\n",
    "   - O erro relativo foi calculado como:\n",
    "     $$\\text{Erro Relativo} = \\frac{\\left| \\bar{y}_{\\text{amostra}} - \\bar{y}_{\\text{população}} \\right|}{\\bar{y}_{\\text{população}}} \\cdot 100$$\n",
    "\n",
    "     Onde:\n",
    "     $$\\bar{y}_{\\text{amostra}} : \\text{Média da variável dependente na amostra.}$$\n",
    "     $$\\bar{y}_{\\text{população}} : \\text{Média da variável dependente no conjunto completo.}$$\n",
    "\n",
    "4. **Comparei os erros relativos**:\n",
    "   - Analisei os erros relativos de cada amostra para identificar qual método de amostragem apresentou melhor desempenho na inferência do valor médio.\n",
    "\n",
    "5. **Resultado**:\n",
    "   - Relatei os erros relativos de cada amostra e identifiquei qual delas foi mais precisa na estimativa do valor médio da variável dependente.\n",
    "\n",
    "Esse processo me permitiu avaliar a qualidade das amostras geradas e determinar qual método de amostragem foi mais eficaz para representar o conjunto de dados original.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "id": "e1faff26",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Distribuição percentual da variável dependente no conjunto completo:\n",
      "('P2_g ', 'Nivel')\n",
      "Sênior    36.790251\n",
      "Pleno     36.090226\n",
      "Júnior    27.119523\n",
      "Name: proportion, dtype: float64\n",
      "\n",
      "Erro relativo da distribuição das amostras:\n",
      "Amostra Estratificada: 2.68%\n",
      "Amostra Aleatória Simples: 2.25%\n",
      "Amostra Sistemática: 3.69%\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "# Calcular a média da variável dependente no conjunto completo\n",
    "dependent_variable = \"('P2_g ', 'Nivel')\" \n",
    "population_distribution = df[dependent_variable].value_counts(normalize=True) * 100\n",
    "print(\"Distribuição percentual da variável dependente no conjunto completo:\")\n",
    "print(population_distribution)\n",
    "simple_random_sample = df.sample(n=sample_size, random_state=42)\n",
    "\n",
    "\n",
    "def calculate_distribution_error(sample, population_distribution, dependent_variable):\n",
    "    sample_distribution = sample[dependent_variable].value_counts(normalize=True) * 100\n",
    "    distribution_error = (sample_distribution - population_distribution).abs().sum() / 2  # Distância total absoluta\n",
    "    return sample_distribution, distribution_error\n",
    "\n",
    "# Comparação com as amostras\n",
    "stratified_sample_distribution, stratified_distribution_error = calculate_distribution_error(\n",
    "    stratified_sample, population_distribution, dependent_variable\n",
    ")\n",
    "\n",
    "simple_random_sample_distribution, simple_random_distribution_error = calculate_distribution_error(\n",
    "    simple_random_sample, population_distribution, dependent_variable\n",
    ")\n",
    "\n",
    "systematic_sample_distribution, systematic_distribution_error = calculate_distribution_error(\n",
    "    systematic_sample, population_distribution, dependent_variable\n",
    ")\n",
    "\n",
    "print(\"\\nErro relativo da distribuição das amostras:\")\n",
    "print(f\"Amostra Estratificada: {stratified_distribution_error:.2f}%\")\n",
    "print(f\"Amostra Aleatória Simples: {simple_random_distribution_error:.2f}%\")\n",
    "print(f\"Amostra Sistemática: {systematic_distribution_error:.2f}%\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "27f7e649",
   "metadata": {},
   "source": [
    "A amostra aleatória simples teve o menor erro (2,25%), sendo a que mais se aproximou da distribuição real. A estratificada também foi precisa (2,68%), o que faz sentido, pois esse método busca manter as proporções. Já a sistemática teve um erro maior (3,69%), podendo ter sofrido viés dependendo da ordenação dos dados."
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [],
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": ".venv",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.3"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 3.977135,
   "end_time": "2025-03-23T21:56:58.725394",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-03-23T21:56:54.748259",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
